{"version":3,"sources":["../src/connect.js"],"names":["mdpErreur","document","querySelector","addLog","yesAdd","noAdd","iLogin","iPsw","connexionContainer","pseudo","getElementById","jobContainer","tabInsert","titleConnexion","addEventListener","e","console","log","style","display","innerHTML","$","submit","evt","preventDefault","formData","FormData","ajax","url","type","data","cache","contentType","enctype","processData","success","response","search","classList","add","remove","insert","login","value","password","connectioooooooon","method","res","create","ps","result","substr","length","fetchDB","raffinery","fetch","JSON","parse","i","jobId","time","labelMinerais","labelVal","val","jobHtml"],"mappings":"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","sourcesContent":["const mdpErreur = document.querySelector(\".mdpError\");\r\nconst addLog = document.querySelector(\".addLog\");\r\nconst yesAdd = document.querySelector(\".yesAdd\");\r\nconst noAdd = document.querySelector(\".noAdd\");\r\n\r\nconst iLogin = document.querySelector(\"#iLogin\");\r\nconst iPsw = document.querySelector(\"#iPsw\");\r\n\r\nconst connexionContainer = document.querySelector(\".connexionContainer\");\r\nconst pseudo = document.getElementById(\"pseudoAct\");\r\nconst jobContainer = document.querySelector(\".jobsContainer\");\r\n\r\nlet tabInsert = {};\r\n\r\n\r\nconst titleConnexion = document.querySelector(\".titleConnexion\");\r\n// A virer, c'est pour le dev uniquement\r\ntitleConnexion.addEventListener(\"mouseover\", (e) => {\r\n    console.log(\"Connecté :D\");\r\n    connexionContainer.style.display = \"none\";\r\n    pseudo.innerHTML = \"Liduen\";\r\n});\r\n\r\n\r\n// traitement du form\r\n$(\"form\").submit(function(evt){\t \r\n    evt.preventDefault();\r\n    let formData = new FormData($(this)[0]);\r\n\r\n    $.ajax({\r\n        url: './src/connect.php',\r\n        type: 'POST',\r\n        data: formData,\r\n        cache: false,\r\n        contentType: false,\r\n        enctype: 'multipart/form-data',\r\n        processData: false,\r\n        success: function (response) {\r\n            console.log(response);\r\n\r\n            if(response.search(\"CRE4TI0N\") !== -1) {\r\n                mdpErreur.classList.add(\"hide\");\r\n                addLog.classList.remove(\"hide\");\r\n\r\n                tabInsert.insert = {};\r\n                tabInsert.insert.login = iLogin.value;\r\n                tabInsert.insert.password = iPsw.value;\r\n\r\n                console.log(tabInsert.insert.login + \" \" + tabInsert.insert.password);\r\n\r\n            } else if(response.search(\"Connect\") !== -1) {\r\n                connectioooooooon(response, false);\r\n\r\n            } else if(response.search(\"pswNo\") !== -1) {\r\n                mdpErreur.classList.remove(\"hide\");\r\n            }\r\n        }\r\n    });\r\n    return false;\r\n});\r\n\r\n//Traitement du btn oui\r\nyesAdd.addEventListener(\"click\", (e) => {\r\n    e.preventDefault();\r\n    $.ajax({\r\n        url:\"./src/connect.php\",\r\n        method: \"POST\",\r\n        data: tabInsert,\r\n        success: function(res) {\r\n            console.log(res);\r\n            connectioooooooon(res, true);\r\n        }\r\n    });\r\n});\r\n\r\nnoAdd.addEventListener(\"click\", (e) => {\r\n    e.preventDefault();\r\n    addLog.classList.add(\"hide\");\r\n    iLogin.value = \"\";\r\n    iPsw.value = \"\";\r\n})\r\n\r\nfunction connectioooooooon(res, create) {\r\n    connexionContainer.style.display = \"none\";\r\n    let ps = res.search(\"Pseudo=\");\r\n    let result = res.substr(ps + 7, res.length)\r\n\r\n    pseudo.innerHTML = result;\r\n    fetchDB(result);\r\n}\r\n\r\nfunction fetchDB(pseudo, raffinery) {\r\n    // Requète ajax pour requérir la BDD\r\n    $.ajax({\r\n        url:\"./src/connect.php\",\r\n        method: \"POST\",\r\n        data: {\r\n            fetch : pseudo,\r\n            raffinery : raffinery\r\n        },\r\n        success: function(res) {\r\n            // console.log(res);\r\n            res = JSON.parse(res)\r\n\r\n            jobContainer.innerHTML = \"\"; //sécurité à enlever ?\r\n            \r\n            if(res.length > 0) {\r\n                // Défilement du tableau et extraction des valeurs\r\n                for(let i = 0;i < res.length;i++) {\r\n                    let jobId;\r\n                    let raffinery;\r\n                    let time;\r\n                    let labelMinerais = \"\";\r\n                    let labelVal = \"\";\r\n                    for (const val in res[i]) {\r\n                        switch(val) {\r\n                            case \"idJob\": \r\n                                jobId = res[i][val];\r\n                            break;\r\n                            case \"fk_idUser\": // x(\r\n                                // Y a rien à voir, dégage.\r\n                            break;\r\n                            case \"Raffinery\":\r\n                                raffinery = res[i][val];\r\n                            break;\r\n                            case \"heurePlace\":\r\n                                time = res[i][val];\r\n                            break;\r\n                            default:\r\n                                if(res[i][val] !== null) {\r\n                                    labelMinerais += `<label>${val}</label>`;\r\n                                    labelVal += `<label>${res[i][val]} cSCU</label>`;\r\n                                }\r\n                        }\r\n                    }\r\n\r\n                    // Setup de l'html avec les variables\r\n                    let jobHtml = `\r\n                    <div class=\"job\" id=\"jobId_${jobId}\">\r\n                        <label class=\"titleJob\">${i + 1}</label>\r\n        \r\n                        <div class=\"mineraisContainer\">\r\n                            <div class=\"mineraisJob\">\r\n                                <div class=\"listeMinerais\">\r\n                                    ${labelMinerais}\r\n                                </div>\r\n                                <span class=\"separate\"></span>\r\n                                <div class=\"listeQuantites\">\r\n                                    ${labelVal}\r\n                                </div>\r\n                            </div>\r\n                            <label class=\"titreCat\">Total de ce Raffinage : </label>\r\n                            <div class=\"tabCat\">\r\n                                250 000 aUEC\r\n                            </div>\r\n                        </div>\r\n        \r\n                        <div class=\"emplacementContainer\">\r\n                            <label class=\"titreCat\">Emplacement : </label>\r\n                            <div class=\"tabCat\">\r\n                                ${raffinery}\r\n                            </div>\r\n                        </div>\r\n        \r\n                        <div class=\"tempsContainer\">\r\n                            <label class=\"titreCat\">Temps Restant : </label>\r\n                            <div class=\"tabCat\">\r\n                                ${time}\r\n                            </div>\r\n                        </div>\r\n        \r\n                        <div class=\"btnsContainer\">\r\n                            <button class=\"btnTransport\">Transporter</button>\r\n                            <button class=\"btnModif\">Modifier</button>\r\n                        </div>\r\n                    </div>`;\r\n        \r\n                    //Affichage des cases remplies\r\n                    jobContainer.innerHTML = jobHtml + jobContainer.innerHTML;\r\n        \r\n                }\r\n            }\r\n        }\r\n    });\r\n}"],"file":"connect.js"}